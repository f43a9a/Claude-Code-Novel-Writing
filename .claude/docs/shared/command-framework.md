---
authority_level: "共通コマンドフレームワーク"
target_audience: ["AI", "システム開発者", "コマンド開発者"]
maintainer: "プロジェクトリード"
last_updated: "2025-01-04"
dependencies:
  - "[[CLAUDE]]"
tags: ["command-framework", "common-patterns", "duplication-prevention"]
---

# 🏗️ 共通コマンドフレームワーク

## 📋 このフレームワークの目的

全8コマンドファイルで共通する要素を統一し、重複を防止しながら一貫性を確保するための基本フレームワーク定義です。

## 🔄 標準処理フロー（4段階）

### 全コマンド共通の基本フロー
```
1. 入力理解と前段階統合処理
   ↓
2. 理論を活用した専門分析  
   ↓
3. 対話による確認・調整
   ↓
4. 最終成果物生成とIssue更新
```

### 各段階の標準機能
- **Stage 1**: GitHub Issue読み込み、前段階ファイル統合、不足情報の特定
- **Stage 2**: shared/instructions理論の適用、専門分析の実行
- **Stage 3**: 自然言語対話による確認、必要に応じた調整・修正
- **Stage 4**: 指定テンプレートでの成果物生成、Issue更新、次段階案内

## 💬 共通対話方針

### 基本姿勢
- **経験豊富な専門家として**: 各コマンドの専門分野における権威的対話
- **自然言語対話重視**: 固定的質問ではなく自然で効果的な会話
- **理論的裏付けの共有**: shared/instructions理論に基づく根拠説明
- **創作意図の尊重**: ユーザーの創作個性・意図を最大限活用

### 対話パターン
```markdown
**情報確認**: 「〜について、さらに詳しく教えていただけますか？」
**理論説明**: 「〜理論によると、このような効果が期待できます」
**提案確認**: 「〜という方向性はいかがでしょうか？」
**調整対応**: 「承知しました。〜のように調整いたします」
```

## 📁 標準出力構造

### 共通出力要素
- **GitHub Issue更新**: 分析結果と次段階への案内
- **ローカルファイル**: `outputs/{issue_number}/output-{command}.md`
- **詳細テンプレート**: `@.claude/docs/{command}/outputs/format.md` 参照

### 標準Issue更新パターン
```markdown
## 🎯 {command}分析完了

### 📊 {専門分野}分析結果
{分析内容のサマリー}

### 🔧 適用した理論・技法
{使用した理論体系}

### 📁 生成ファイル
- `outputs/{issue_number}/output-{command}.md`

### 🚀 次のステップ
```bash
/{next_command} {issue_number}
```
```

## ❌ 共通エラーハンドリング

### 標準エラー対応
- **前段階ファイル不足**: 対話による情報収集で補完
- **AI分析失敗**: 理論見直しによる再試行
- **成果物生成失敗**: 代替手法による再生成
- **理論適用の一貫性問題**: 統合性チェックと調整

## 🔗 理論参照の標準化

### shared/instructions活用パターン
```markdown
**基盤理論**:
- writer_mbti_patterns/{type}.md (創作アプローチ最適化)
- genre/{genre}.md (ジャンル特性活用)  
- audience/{audience}.md (読者層最適化)

**専門理論**:
- {command}固有の理論ディレクトリ
- 段階に応じた前段階理論の継承
```

## 📈 改善統合指針

### 品質改善システム活用
- **Critical Fix**: @.claude/docs/shared/quality-improvement-system.md
- **Quality Enhancement**: 同上
- **Appeal Amplification**: 同上

### 継続的改善
- 理論の更新に伴う自動的な改善反映
- ユーザーフィードバックに基づく柔軟な調整
- 段階間の連携最適化

---

**活用方針**: 新規コマンド開発時はこのフレームワークに準拠し、既存コマンドは段階的にこのパターンに統合することで、システム全体の一貫性と保守性を確保する